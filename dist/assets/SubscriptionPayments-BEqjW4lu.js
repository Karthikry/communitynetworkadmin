import{r,j as e,B as m,A as n,G as y,F as M,H as k,b,c as E,a as f}from"./index-BCMjTDj-.js";import{C as z}from"./CircularProgress-DMkT-NtX.js";import{A as $}from"./Alert-BxmTgsDR.js";import{P as L}from"./Pagination-DQU4BYDd.js";import{D as F,a as G}from"./DialogTitle-D85XLa7F.js";import{D as H}from"./DialogContent-B8Y-o2C7.js";import{T as J,a as O,b as R,c as S,d as a,e as W}from"./TableRow-C6k8ikuc.js";import{D as q}from"./DialogActions-Db_kJuz6.js";import"./LastPage-aK0Jz_ev.js";const te=()=>{const[p,D]=r.useState([]),[o,x]=r.useState(!0),[i,u]=r.useState(""),[c,P]=r.useState(0),[g,C]=r.useState(1),[j,T]=r.useState([]),[v,l]=r.useState(!1),w=9,N=async t=>{x(!0),u("");try{const s=JSON.parse(sessionStorage.getItem("user")),d=(s==null?void 0:s.accessToken)||"",h=await f.get(`https://executivetracking.cloudjiffy.net/Mahaasabha/subscription/v1/getAllSubscriptionsByPagination/{pageNumber}/{pageSize}?pageNumber=${t}&pageSize=${w}`,{headers:{"Content-type":"application/json",Authorization:`Bearer ${d}`}});D(h.data.content||[]),C(h.data.totalPages||1)}catch(s){console.error("Error fetching subscription data:",s),u("Failed to fetch subscription payments.")}finally{x(!1)}};r.useEffect(()=>{N(c)},[c]);const A=(t,s)=>{P(s-1)},B=async t=>{try{const s=JSON.parse(sessionStorage.getItem("user")),d=(s==null?void 0:s.accessToken)||"";return(await f.get(`https://executivetracking.cloudjiffy.net/MahaasabhaMember/subscription/v1/getAllPaymentsBySubscriptionId/{subscriptionId}?subscriptionId=${t}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`}})).data}catch(s){return console.error("Error fetching payment details:",s),[]}},I=async t=>{const s=await B(t);T(s),l(!0)};return e.jsxs(m,{sx:{padding:2},children:[e.jsx(n,{variant:"h4",gutterBottom:!0,children:"Subscriptions"}),o&&e.jsx(m,{sx:{display:"flex",justifyContent:"center",marginTop:4},children:e.jsx(z,{})}),i&&e.jsx($,{severity:"error",sx:{marginBottom:4},children:i}),e.jsxs(y,{container:!0,spacing:3,children:[!o&&!i&&p.length===0&&e.jsx(n,{variant:"h6",sx:{textAlign:"center",width:"100%"},children:"No subscription payments found."}),p.map(t=>e.jsx(y,{item:!0,xs:12,sm:6,md:4,children:e.jsx(M,{variant:"outlined",children:e.jsxs(k,{children:[e.jsxs(n,{variant:"h6",gutterBottom:!0,children:["Member: ",t.mahaasabhaMemberDto.userName]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Subscription ID:"})," ",t.subscriptionId]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Mobile Number:"})," ",t.mahaasabhaMemberDto.mobileNumber||"N/A"]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Status:"})," ",t.status]}),e.jsxs(n,{children:[e.jsx("strong",{children:"Start Date:"})," ",new Date(t.startDate).toLocaleDateString()]}),e.jsxs(n,{children:[e.jsx("strong",{children:"End Date:"})," ",new Date(t.endDate).toLocaleDateString()]}),e.jsx(b,{variant:"contained",color:"primary",size:"small",style:{marginTop:"16px"},onClick:()=>I(t.subscriptionId),children:"Show Payment Details"})]})})},t.subscriptionId))]}),!o&&g>1&&e.jsx(m,{sx:{display:"flex",justifyContent:"center",marginTop:4},children:e.jsx(L,{count:g,page:c+1,onChange:A,color:"primary"})}),e.jsxs(F,{open:v,onClose:()=>l(!1),fullWidth:!0,maxWidth:"sm",children:[e.jsx(G,{children:"Payment Details"}),e.jsx(H,{children:j.length===0?e.jsx(n,{children:"No payment details available."}):e.jsx(J,{component:E,children:e.jsxs(O,{children:[e.jsx(R,{children:e.jsxs(S,{children:[e.jsx(a,{children:"Payment ID"}),e.jsx(a,{children:"Amount"}),e.jsx(a,{children:"Payment Date"}),e.jsx(a,{children:"Method"}),e.jsx(a,{children:"Status"})]})}),e.jsx(W,{children:j.map(t=>e.jsxs(S,{children:[e.jsx(a,{children:t.paymentid}),e.jsx(a,{children:t.amount}),e.jsx(a,{children:new Date(t.paymentDate).toLocaleDateString()}),e.jsx(a,{children:t.paymentMethod}),e.jsx(a,{children:t.status})]},t.paymentId))})]})})}),e.jsx(q,{children:e.jsx(b,{onClick:()=>l(!1),color:"primary",children:"Close"})})]})]})};export{te as default};
