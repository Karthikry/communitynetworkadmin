import{y as ge,j as e,v as ee,w as te,r as l,B,A as n,a as M,G as P,F as re,H as se,b as v,I as L,T as W,ae as ue}from"./index-BCMjTDj-.js";import{G as V,q as F}from"./index.module-C9gx2M6Y.js";import{C as G}from"./CircularProgress-DMkT-NtX.js";import{D as E,a as J}from"./DialogTitle-D85XLa7F.js";import{D as I}from"./DialogContent-B8Y-o2C7.js";const xe=ge(e.jsx("path",{d:"M3 17v2h6v-2zM3 5v2h10V5zm10 16v-2h8v-2h-8v-2h-2v6zM7 9v2H3v2h4v2h2V9zm14 4v-2H11v2zm-6-4h2V7h4V5h-4V3h-2z"}),"Tune");var q={},ye=te;Object.defineProperty(q,"__esModule",{value:!0});var ae=q.default=void 0,me=ye(ee()),je=e;ae=q.default=(0,me.default)((0,je.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");const T="/assets/Male-removebg-preview-Ci97rV_x.png",k="/assets/Female-removebg-preview-CghNqdlA.png";var H={},fe=te;Object.defineProperty(H,"__esModule",{value:!0});var _=H.default=void 0,ve=fe(ee()),be=e;_=H.default=(0,ve.default)((0,be.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");const Ce=({membershipCode:i})=>{const[x,o]=l.useState(null),[d,r]=l.useState(!0),[t,p]=l.useState(null);l.useEffect(()=>{(async()=>{var h;try{const a=JSON.parse(sessionStorage.getItem("user")),j={"Content-type":"application/json",Authorization:`Bearer ${(a==null?void 0:a.accessToken)||""}`},f=await M.get(`https://executivetracking.cloudjiffy.net/Mahaasabha/membership/v1/findFatherRootFamilyTreeByMembershipCode/${i}`,{headers:j});o(f.data)}catch(a){((h=a.response)==null?void 0:h.status)===404?(console.error("No data found for the provided membership code:",i),p("No family tree data found.")):(console.error("Error fetching family tree data:",a),p("An unexpected error occurred. Please try again later."))}finally{r(!1)}})()},[i]);const g=u=>{if(!u)return null;const h=(a,b="Self")=>{var y,N,R;if(!a)return null;const j=e.jsx("img",{src:a.gender==="MALE"?T:k,alt:a.gender==="MALE"?"Male":"Female",style:{width:50,height:50}}),f=a.isAlive?"lightgreen":"lightcoral",D=((y=a.relationships)==null?void 0:y.length)>0?a.relationships[0].relationshipName:b;return e.jsxs(F,{label:e.jsxs(B,{sx:{padding:1,borderRadius:1,border:"1px solid #ccc",backgroundColor:f,display:"inline-block",textAlign:"center"},children:[j,e.jsx(n,{variant:"body1",children:a.fullName}),e.jsxs(n,{variant:"body2",color:"textSecondary",children:["(",D,")"]})]}),children:[(N=a.spouseMemberships)==null?void 0:N.map(A=>h(A,"Spouse")),(R=a.childrenMemberships)==null?void 0:R.map(A=>h(A,"Child"))]},a.membershipId)};return e.jsx(V,{lineWidth:"2px",lineColor:"green",lineBorderRadius:"10px",children:h(u)})};return e.jsxs(B,{sx:{textAlign:"center",mt:4},children:[d&&e.jsx(G,{}),t&&e.jsx(n,{color:"error",children:t}),!d&&!t&&x?g(x[0]):e.jsx(n,{children:"No data found"})]})},ie=({membershipCode:i})=>{const[x,o]=l.useState(null),[d,r]=l.useState(!0),[t,p]=l.useState(null);l.useEffect(()=>{(async()=>{var h;try{const a=JSON.parse(sessionStorage.getItem("user")),j={"Content-type":"application/json",Authorization:`Bearer ${(a==null?void 0:a.accessToken)||""}`},f=await M.get(`https://executivetracking.cloudjiffy.net/Mahaasabha/membership/v1/findRootFamilyTreeByMembershipCode/${i}`,{headers:j});o(f.data)}catch(a){((h=a.response)==null?void 0:h.status)===404?(console.error("No data found for the provided membership code:",i),p("No family tree data found.")):(console.error("Error fetching family tree data:",a),p("An unexpected error occurred. Please try again later."))}finally{r(!1)}})()},[i]);const g=u=>{if(!u)return null;const h=(a,b="Self")=>{var y,N,R;if(!a)return null;const j=e.jsx("img",{src:a.gender==="MALE"?T:k,alt:a.gender==="MALE"?"Male":"Female",style:{width:50,height:50}}),f=a.isAlive?"lightgreen":"lightcoral",D=((y=a.relationships)==null?void 0:y.length)>0?a.relationships[0].relationshipName:b;return e.jsxs(F,{label:e.jsxs(B,{sx:{padding:1,borderRadius:1,border:"1px solid #ccc",backgroundColor:f,display:"inline-block",textAlign:"center"},children:[j,e.jsx(n,{variant:"body1",children:a.fullName}),e.jsxs(n,{variant:"body2",color:"textSecondary",children:["(",D,")"]})]}),children:[(N=a.spouseMemberships)==null?void 0:N.map(A=>h(A,"Spouse")),(R=a.childrenMemberships)==null?void 0:R.map(A=>h(A,"Child"))]},a.membershipId)};return e.jsx(V,{lineWidth:"2px",lineColor:"green",lineBorderRadius:"10px",children:h(u)})};return e.jsxs(B,{sx:{textAlign:"center",mt:4},children:[d&&e.jsx(G,{}),t&&e.jsx(n,{color:"error",children:t}),!d&&!t&&x?g(x[0]):e.jsx(n,{children:"No data found"})]})},Se=({member:i,onViewDetails:x,onViewFamilyTree:o,onViewRootFamilyTree:d})=>{const[r,t]=l.useState(!1),[p,g]=l.useState(!1),[u,h]=l.useState(""),a=y=>{h(y),console.log(y),t(!0)},b=()=>{t(!1)},j=y=>{h(y),console.log(y),g(!0)},f=()=>{g(!1)},D=i.gender==="MALE";return e.jsxs(e.Fragment,{children:[e.jsx(P,{item:!0,xs:12,sm:12,md:12,children:e.jsx(re,{style:{backgroundColor:i.isAlive?"lightgreen":"lightcoral",marginBottom:"20px"},children:e.jsxs(se,{children:[e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"10px"},children:e.jsx("img",{src:D?T:k,alt:D?"Male":"Female",style:{width:50,height:50}})}),e.jsx(n,{variant:"h5",children:i.fullName}),e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Date of Birth:"})," ",new Date(i.dob).toLocaleDateString()]}),e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Application Number:"})," ",i.applicationNumber]}),e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Membership Code:"})," ",i.membershipCode]}),e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Reference Membership Code:"})," ",i.referanceMembershipCode]}),e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Female Family Ref Membership Code:"})," ",i.femaleFamilyRefMembershipCode]}),e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Status:"})," ",i.isAlive?"Alive":"Deceased"]}),e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Married:"})," ",i.isMarried?"Yes":"No"]}),e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Age:"})," ",i.age]}),e.jsxs(n,{variant:"body1",children:[e.jsx("strong",{children:"Gotra:"})," ",i.gothra]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,marginTop:"15px"},children:[e.jsx(v,{variant:"contained",style:{backgroundColor:"white",color:"blue",border:"1px solid blue"},onClick:o,children:"Family Tree"}),e.jsx(v,{variant:"contained",style:{backgroundColor:"white",color:"purple",border:"1px solid purple"},onClick:x,children:"Personal Text"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,marginTop:"10px"},children:[i.gender=="MALE"?e.jsx(v,{variant:"contained",style:{backgroundColor:"white",color:"blue",border:"1px solid blue"},onClick:()=>j(i.membershipCode),children:"Root Family Tree"}):"",i.gender==="FEMALE"&&i.isMarried?e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"contained",style:{backgroundColor:"white",color:"blue",border:"1px solid blue"},onClick:()=>j(i.membershipCode),children:"Husband Root Family Tree"}),e.jsx(v,{variant:"contained",style:{backgroundColor:"white",color:"purple",border:"1px solid purple"},onClick:()=>a(i.membershipCode),children:"Father Root Family Tree"})]}):i.gender==="FEMALE"&&!i.isMarried?e.jsx(v,{variant:"contained",style:{backgroundColor:"white",color:"purple",border:"1px solid purple"},onClick:()=>a(i.membershipCode),children:"Father Root Family Tree"}):null]})]})})},i.membershipCode),e.jsx(E,{open:p,onClose:f,fullWidth:!0,maxWidth:"lg",children:e.jsxs(I,{children:[e.jsx(L,{style:{position:"absolute",top:10,right:10},onClick:f,children:e.jsx(_,{})}),e.jsx(ie,{membershipCode:u})]})}),e.jsx(E,{open:r,onClose:b,fullWidth:!0,maxWidth:"lg",children:e.jsxs(I,{children:[e.jsx(L,{style:{position:"absolute",top:10,right:10},onClick:b,children:e.jsx(_,{})}),e.jsx(Ce,{membershipCode:u})]})})]})},Fe=({open:i,onClose:x,selectedMemberDetails:o,fetchMemberDetails:d})=>e.jsxs(E,{open:i,onClose:x,maxWidth:"sm",fullWidth:!0,children:[e.jsx(J,{children:"Personal Details"}),e.jsx(I,{children:o?e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[e.jsx("img",{src:o.gender==="MALE"?T:k,alt:o.gender==="MALE"?"Male":"Female",style:{width:50,height:50}}),e.jsx(n,{variant:"h5",style:{backgroundColor:o.isAlive?"lightgreen":"lightpink",padding:"5px",borderRadius:"5px",marginLeft:"10px"},children:o.fullName})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx(n,{variant:"h6",color:"primary",children:"Parents"}),o.parentsDTO&&o.parentsDTO.length>0?o.parentsDTO.map(r=>e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[e.jsx("img",{src:r.gender==="MALE"?T:k,alt:r.gender==="MALE"?"Male":"Female",style:{width:50,height:50}}),e.jsx(v,{onClick:()=>d(r.membershipCode),children:e.jsx(n,{variant:"body1",style:{backgroundColor:r.isAlive?"lightgreen":"lightpink",padding:"5px",borderRadius:"5px",marginLeft:"10px"},children:r.fullName})})]}),r.spouses&&r.spouses.length>0&&r.spouses.map(t=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[e.jsx("img",{src:t.gender==="MALE"?T:k,alt:t.gender==="MALE"?"Male":"Female",style:{width:50,height:50}}),e.jsx(v,{onClick:()=>d(t.membershipCode),children:e.jsx(n,{variant:"body1",style:{backgroundColor:t.isAlive?"lightgreen":"lightpink",padding:"5px",borderRadius:"5px",marginLeft:"10px"},children:t.fullName})})]},t.membershipId))]},r.membershipId)):e.jsx(n,{variant:"body2",color:"textSecondary",children:"No parents data found."})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx(n,{variant:"h6",color:"primary",children:"Siblings"}),o.siblingsDto&&o.siblingsDto.length>0?o.siblingsDto.map(r=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[e.jsx("img",{src:r.gender==="MALE"?T:k,alt:r.gender==="MALE"?"Male":"Female",style:{width:50,height:50}}),e.jsx(v,{onClick:()=>d(r.membershipCode),children:e.jsx(n,{variant:"body1",style:{backgroundColor:r.isAlive?"lightgreen":"lightpink",padding:"5px",borderRadius:"5px",marginLeft:"10px"},children:r.fullName})})]},r.membershipId)):e.jsx(n,{variant:"body2",color:"textSecondary",children:"No siblings data found."})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx(n,{variant:"h6",color:"primary",children:"Spouse"}),o.spouseDto&&o.spouseDto.length>0?o.spouseDto.map(r=>e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("img",{src:r.gender==="MALE"?T:k,alt:r.gender==="MALE"?"Male":"Female",style:{width:50,height:50}}),e.jsx(v,{onClick:()=>d(r.membershipCode),children:e.jsx(n,{variant:"body1",style:{backgroundColor:r.isAlive?"lightgreen":"lightpink",padding:"5px",borderRadius:"5px",marginLeft:"10px"},children:r.fullName})})]},r.membershipId)):e.jsx(n,{variant:"body2",color:"textSecondary",children:"No spouse data found."})]}),e.jsxs("div",{children:[e.jsx(n,{variant:"h6",color:"primary",children:"Children"}),o.childrenDto&&o.childrenDto.length>0?o.childrenDto.map(r=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[e.jsx("img",{src:r.gender==="MALE"?T:k,alt:r.gender==="MALE"?"Male":"Female",style:{width:50,height:50}}),e.jsx(v,{onClick:()=>d(r.membershipCode),children:e.jsx(n,{variant:"body1",style:{backgroundColor:r.isAlive?"lightgreen":"lightpink",padding:"5px",borderRadius:"5px",marginLeft:"10px"},children:r.fullName})})]},r.membershipId)):e.jsx(n,{variant:"body2",color:"textSecondary",children:"No children data found."})]})]}):e.jsx(n,{children:"Loading details..."})})]}),Te=({open:i,onClose:x,selectedFamilyTree:o})=>{const d=({member:t})=>e.jsxs(re,{style:{backgroundColor:t.isAlive?"#90EE90":"#ee6b6e",margin:"10px",minWidth:"120px"},children:[console.log(t),e.jsxs(se,{style:{display:"flex",alignItems:"center"},children:[e.jsx("img",{src:t.gender==="MALE"?T:k,alt:t.gender==="MALE"?"Male":"Female",style:{width:50,height:50}}),e.jsx(n,{variant:"body1",color:"white",children:t.fullName})]})]}),r=t=>e.jsx("div",{children:e.jsxs(F,{label:e.jsx(d,{member:t}),children:[t.parentsDTO&&t.parentsDTO.map((p,g)=>e.jsx(F,{label:e.jsx(d,{member:p}),children:p.spouses&&p.spouses.map((u,h)=>e.jsx(F,{label:e.jsx(d,{member:u})},`parent-spouse-${h}`))},`parent-${g}`)),t.siblingsDto&&t.siblingsDto.length>0&&e.jsx(F,{label:e.jsx(n,{variant:"body1",color:"primary",children:"Siblings"}),children:t.siblingsDto.map((p,g)=>e.jsx(F,{label:e.jsx(d,{member:p})},`sibling-${g}`))}),t.spouseDto&&t.spouseDto.length>0&&e.jsx(F,{label:e.jsx(n,{variant:"body1",color:"primary",children:"Spouse"}),children:t.spouseDto.map((p,g)=>e.jsx(F,{label:e.jsx(d,{member:p})},`spouse-${g}`))}),t.childrenDto&&t.childrenDto.length>0&&e.jsx(F,{label:e.jsx(n,{variant:"body1",color:"primary",children:"Children"}),children:t.childrenDto.map(p=>r(p))})]})});return e.jsxs(E,{open:i,onClose:x,maxWidth:"lg",fullWidth:!0,children:[e.jsx(J,{children:"Family Tree"}),e.jsx(I,{children:o&&e.jsx(V,{lineWidth:"2px",lineColor:"blue",lineBorderRadius:"10px",children:r(o)})})]})},Re=()=>{const[i,x]=l.useState(""),[o,d]=l.useState([]),[r,t]=l.useState(""),[p,g]=l.useState(!1),[u,h]=l.useState(!1),[a,b]=l.useState(!1),[j,f]=l.useState(null),[D,y]=l.useState(null),[N,R]=l.useState(null),[A,S]=l.useState(!1),[$,O]=l.useState(!1),[w,K]=l.useState("gotra"),[z,Q]=l.useState(""),[ne,U]=l.useState([]),[oe,Y]=l.useState([]),le=async()=>{try{const s=JSON.parse(sessionStorage.getItem("user")),c=(s==null?void 0:s.accessToken)||"",m=await M.get("https://executivetracking.cloudjiffy.net/Mahaasabha/gotra/v1/getAllGotraByPagination/{pageNumber}/{pageSize}?pageNumber=0&pageSize=10",{headers:{Authorization:`Bearer ${c}`}}),C=await M.get("https://executivetracking.cloudjiffy.net/Mahaasabha/city/v1/getAllCityByPagination/{pageNumber}/{pageSize}?pageNumber=0&pageSize=10",{headers:{Authorization:`Bearer ${c}`}});Array.isArray(m.data.content)?U(m.data.content):(console.error("Gotra response is not an array:",m.data),U([])),Array.isArray(C.data.content)?Y(C.data.content):(console.error("City response is not an array:",C.data),Y([]))}catch(s){console.error("Failed to fetch gotras or cities",s)}};l.useEffect(()=>{$&&le()},[$]);const X=async s=>{S(!0),t("");try{const c=JSON.parse(sessionStorage.getItem("user")),m=(c==null?void 0:c.accessToken)||"",C=await M.get(`https://executivetracking.cloudjiffy.net/Mahaasabha/membership/v1/findMembershipByFullName?fullName=${s}`,{headers:{Authorization:`Bearer ${m}`}});d(C.data||[])}catch{t("Failed to fetch results")}S(!1)},ce=async()=>{S(!0),t("");try{const s=JSON.parse(sessionStorage.getItem("user")),c=(s==null?void 0:s.accessToken)||"",m=await M.get("https://executivetracking.cloudjiffy.net/Mahaasabha/membership/v1/findMembershipByFullNameAndFilter?city=Bengaluru&fullName=rao&gothra=KAUSHIKA",{headers:{Authorization:`Bearer ${c}`},params:{type:w,value:z}});d(m.data||[])}catch{t("Failed to fetch filtered results")}S(!1),O(!1)},de=s=>{s.preventDefault(),ce()},he=async s=>{S(!0);try{const c=JSON.parse(sessionStorage.getItem("user")),m=(c==null?void 0:c.accessToken)||"",C=await M.get(`https://executivetracking.cloudjiffy.net/MahaasabhaMember/membership/v1/findMembershipAssociationByMembershipCode/{membershipCode}?membershipCode=${s}`,{headers:{Authorization:`Bearer ${m}`}});y(C.data),h(!0)}catch{t("Failed to fetch family tree data")}S(!1)},pe=async s=>{S(!0);try{const c=JSON.parse(sessionStorage.getItem("user")),m=(c==null?void 0:c.accessToken)||"",C=await M.get(`https://executivetracking.cloudjiffy.net/Mahaasabha/membership/v1/findRootFamilyTreeByMembershipCode/${s}`,{headers:{Authorization:`Bearer ${m}`}});R(C.data),b(!0)}catch{t("Failed to fetch root family tree data")}S(!1)},Z=async s=>{S(!0);try{const c=JSON.parse(sessionStorage.getItem("user")),m=(c==null?void 0:c.accessToken)||"",C=await M.get(`https://executivetracking.cloudjiffy.net/MahaasabhaMember/membership/v1/findMembershipAssociationByMembershipCode/{membershipCode}?membershipCode=${s}`,{headers:{Authorization:`Bearer ${m}`}});f(C.data),g(!0)}catch{t("Failed to fetch member details")}S(!1)};return e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("form",{onSubmit:s=>{s.preventDefault(),X(i)},style:{display:"flex",justifyContent:"center",marginBottom:"20px"},children:e.jsx(W,{placeholder:"Search a FullName",variant:"outlined",value:i,onChange:s=>x(s.target.value),style:{width:"70%"},InputProps:{endAdornment:e.jsxs(ue,{position:"end",children:[e.jsx(L,{onClick:()=>X(i),color:"primary",children:e.jsx(ae,{})}),e.jsx(L,{color:"primary",onClick:()=>O(!0),children:e.jsx(xe,{})})]})}})}),A&&e.jsx(G,{style:{marginTop:"20px"}}),r&&e.jsx(n,{color:"error",children:r}),e.jsx(P,{container:!0,spacing:3,style:{padding:"10px"},children:o.map(s=>e.jsx(P,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Se,{member:s,onViewDetails:()=>Z(s.membershipCode),onViewFamilyTree:()=>he(s.membershipCode),onViewRootFamilyTree:()=>pe(s.membershipCode)})},s.membershipCode))}),e.jsx(Fe,{open:p,onClose:()=>g(!1),selectedMemberDetails:j,fetchMemberDetails:Z}),e.jsx(Te,{open:u,onClose:()=>h(!1),selectedFamilyTree:D}),e.jsx(ie,{open:a,onClose:()=>b(!1),selectedRootFamilyTree:N}),e.jsxs(E,{open:$,onClose:()=>O(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(J,{children:"Filter Members"}),e.jsx(I,{children:e.jsxs("form",{onSubmit:de,children:[e.jsxs("div",{children:[e.jsxs("label",{children:[e.jsx("input",{type:"radio",value:"gotra",checked:w==="gotra",onChange:()=>K("gotra")}),"Gotra"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",value:"city",checked:w==="city",onChange:()=>K("city")}),"City"]})]}),w==="gotra"?e.jsxs(W,{select:!0,label:"",variant:"outlined",fullWidth:!0,value:z,onChange:s=>Q(s.target.value),SelectProps:{native:!0},style:{marginTop:"10px"},children:[e.jsx("option",{value:"",children:"-- Select Gotra --"}),ne.map(s=>e.jsx("option",{value:s.gotraName,children:s.gotraName},s.gotraId))]}):e.jsxs(W,{select:!0,label:"",variant:"outlined",fullWidth:!0,value:z,onChange:s=>Q(s.target.value),SelectProps:{native:!0},style:{marginTop:"10px"},children:[e.jsx("option",{value:"",children:"-- Select City --"}),oe.map(s=>e.jsx("option",{value:s.cityName,children:s.cityName},s.cityId))]}),e.jsx(v,{type:"submit",variant:"contained",color:"primary",style:{marginTop:"10px"},children:"Apply Filter"})]})})]})]})};export{Re as default};
