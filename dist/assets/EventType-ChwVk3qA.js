import{r as d,j as t,c as J,b as T,I as D,T as w}from"./index-BCMjTDj-.js";import{d as M}from"./Edit-BAFAy0Gz.js";import{d as R}from"./Delete-DQ5tIu97.js";import{T as H,a as L,b as U,c as g,d as p,e as _}from"./TableRow-C6k8ikuc.js";import{T as G}from"./TablePagination-au4wXnx7.js";import{D as V,a as Y}from"./DialogTitle-D85XLa7F.js";import{D as q}from"./DialogContent-B8Y-o2C7.js";import{D as K}from"./DialogActions-Db_kJuz6.js";import"./LastPage-aK0Jz_ev.js";const f=[{id:"eventTypeId",label:"Event Type ID",minWidth:120},{id:"eventTypeName",label:"Event Type Name",minWidth:180},{id:"description",label:"Description",minWidth:200},{id:"createdBy",label:"Created By",minWidth:150},{id:"updatedBy",label:"Updated By",minWidth:150},{id:"insertedDate",label:"Inserted Date",minWidth:180},{id:"updatedDate",label:"Updated Date",minWidth:180},{id:"edit",label:"Edit",minWidth:80},{id:"delete",label:"Delete",minWidth:80}],re=()=>{const[c,x]=d.useState(0),[l,S]=d.useState(10),[b,C]=d.useState([]),[k,I]=d.useState(0),[j,h]=d.useState(null),[B,N]=d.useState(!1),[v,P]=d.useState("add"),[r,y]=d.useState({eventTypeId:0,eventTypeName:"",description:""});d.useEffect(()=>{u()},[c,l]);const u=async()=>{try{const e=JSON.parse(sessionStorage.getItem("user")),a=(e==null?void 0:e.accessToken)||"",n=await fetch(`https://executivetracking.cloudjiffy.net/Mahaasabha/eventtype/v1/getAllEventTypeByPagination/{pageNumber}/{pageSize}?pageNumber=${c}&pageSize=${l}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}});if(!n.ok)throw new Error(`Error: ${n.statusText}`);const s=await n.json(),i=s.content.map(o=>({eventTypeId:o.eventTypeId,eventTypeName:o.eventTypeName,description:o.description,createdBy:o.createdBy.fullName||o.createdBy.userName,updatedBy:o.updatedBy.fullName||o.updatedBy.userName,insertedDate:new Date(o.insertedDate).toLocaleDateString(),updatedDate:new Date(o.updatedDate).toLocaleDateString()}));C(i),I(s.totalElements)}catch(e){h(e.message),console.error("Failed to fetch event types:",e)}},W=(e,a)=>{x(a)},A=e=>{S(+e.target.value),x(0)},E=(e,a={})=>{P(e),y(a),N(!0)},m=()=>{N(!1),y({eventTypeId:0,eventTypeName:"",description:""})},$=async()=>{v==="add"?await O():await F()},O=async()=>{try{const e=JSON.parse(sessionStorage.getItem("user")),a=(e==null?void 0:e.accessToken)||"",n={eventTypeName:r.eventTypeName,description:r.description,createdBy:{fullName:e.fullName||e.userName,mobileNumber:e.mobileNumber,userId:e.userId,userName:e.userName}},s=await fetch("https://executivetracking.cloudjiffy.net/Mahaasabha/eventtype/v1/createEventType",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(n)});if(!s.ok){const i=await s.json();throw console.error("Failed to add event type:",i),new Error(`Error: ${s.statusText}`)}u(),m()}catch(e){h(e.message),console.error("Failed to add event type:",e)}},F=async()=>{try{const e=JSON.parse(sessionStorage.getItem("user")),a=(e==null?void 0:e.accessToken)||"",n={eventTypeId:r.eventTypeId,eventTypeName:r.eventTypeName,description:r.description,updatedBy:{fullName:e.fullName||e.userName,mobileNumber:e.mobileNumber,userId:e.userId,userName:e.userName}},s=await fetch("https://executivetracking.cloudjiffy.net/Mahaasabha/eventtype/v1/updateEventType",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(n)});if(!s.ok){const i=await s.json();throw console.error("Failed to edit event type:",i),new Error(`Error: ${s.statusText}`)}u(),m()}catch(e){h(e.message),console.error("Failed to edit event type:",e)}},z=async e=>{if(window.confirm("Are you sure you want to delete this event type?"))try{const n=JSON.parse(sessionStorage.getItem("user")),s=(n==null?void 0:n.accessToken)||"",i=await fetch(`https://executivetracking.cloudjiffy.net/Mahaasabha/eventtype/v1/deleteEventTypeById/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});if(!i.ok){const o=await i.json();throw console.error("Failed to delete event type:",o),new Error(`Error: ${i.statusText}`)}u()}catch(n){h(n.message),console.error("Failed to delete event type:",n)}};return t.jsxs(J,{sx:{width:"100%",overflow:"hidden",mt:5},children:[t.jsx(T,{variant:"contained",sx:{margin:"10px"},onClick:()=>E("add"),children:"+ ADD EVENT TYPE"}),j&&t.jsxs("div",{style:{color:"red",textAlign:"center"},children:["Error: ",j]}),t.jsx(H,{sx:{maxHeight:440},children:t.jsxs(L,{stickyHeader:!0,"aria-label":"sticky table",children:[t.jsx(U,{children:t.jsx(g,{children:f.map(e=>t.jsx(p,{align:e.align||"left",style:{minWidth:e.minWidth,fontWeight:"bold"},children:e.label},e.id))})}),t.jsx(_,{children:b.length>0?b.slice(c*l,c*l+l).map(e=>t.jsx(g,{hover:!0,role:"checkbox",tabIndex:-1,children:f.map(a=>{const n=e[a.id];return a.id==="edit"?t.jsx(p,{align:"left",children:t.jsx(D,{onClick:()=>E("edit",e),color:"primary",children:t.jsx(M,{})})},a.id):a.id==="delete"?t.jsx(p,{align:"left",children:t.jsx(D,{onClick:()=>z(e.eventTypeId),color:"secondary",children:t.jsx(R,{})})},a.id):t.jsx(p,{align:a.align||"left",children:n||"Not Available"},a.id)})},e.eventTypeId)):t.jsx(g,{children:t.jsx(p,{colSpan:f.length,align:"center",sx:{padding:20},children:"No rows"})})})]})}),t.jsx(G,{rowsPerPageOptions:[10,25,100],component:"div",count:k,rowsPerPage:l,page:c,onPageChange:W,onRowsPerPageChange:A}),t.jsxs(V,{open:B,onClose:m,children:[t.jsx(Y,{children:v==="add"?"Add Event Type":"Edit Event Type"}),t.jsxs(q,{children:[t.jsx(w,{autoFocus:!0,margin:"dense",label:"Event Type Name",fullWidth:!0,variant:"outlined",value:r.eventTypeName,onChange:e=>y({...r,eventTypeName:e.target.value})}),t.jsx(w,{margin:"dense",label:"Description",fullWidth:!0,variant:"outlined",value:r.description,onChange:e=>y({...r,description:e.target.value})})]}),t.jsxs(K,{children:[t.jsx(T,{onClick:m,children:"Cancel"}),t.jsx(T,{onClick:$,children:v==="add"?"Add":"Save"})]})]})]})};export{re as default};
