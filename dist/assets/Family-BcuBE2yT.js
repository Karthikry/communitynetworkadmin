import{K as le,ac as ce,u as de,r as M,j as l,M as ue,G as te,g as he,b as I,c as fe,T as me}from"./index-BCMjTDj-.js";import{T as pe,a as ye,b as be,c as re,d as Z,e as ge}from"./TableRow-C6k8ikuc.js";import{T as $e}from"./TablePagination-au4wXnx7.js";import{D as ie,a as ne}from"./DialogTitle-D85XLa7F.js";import{D as ae}from"./DialogContent-B8Y-o2C7.js";import{D as se}from"./DialogActions-Db_kJuz6.js";import"./LastPage-aK0Jz_ev.js";var oe={exports:{}};(function(q,G){(function(P,S){q.exports=S()})(le,function(){var P=1e3,S=6e4,J=36e5,H="millisecond",w="second",C="minute",T="hour",$="day",N="week",b="month",F="quarter",D="year",v="date",k="Invalid Date",R=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Q=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,K={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var r=["th","st","nd","rd"],t=a%100;return"["+a+(r[(t-20)%10]||r[t]||r[0])+"]"}},W=function(a,r,t){var n=String(a);return!n||n.length>=r?a:""+Array(r+1-n.length).join(t)+a},X={s:W,z:function(a){var r=-a.utcOffset(),t=Math.abs(r),n=Math.floor(t/60),i=t%60;return(r<=0?"+":"-")+W(n,2,"0")+":"+W(i,2,"0")},m:function a(r,t){if(r.date()<t.date())return-a(t,r);var n=12*(t.year()-r.year())+(t.month()-r.month()),i=r.clone().add(n,b),s=t-i<0,o=r.clone().add(n+(s?-1:1),b);return+(-(n+(t-i)/(s?i-o:o-i))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:b,y:D,w:N,d:$,D:v,h:T,m:C,s:w,ms:H,Q:F}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},j="en",x={};x[j]=K;var U="$isDayjsObject",L=function(a){return a instanceof d||!(!a||!a[U])},_=function a(r,t,n){var i;if(!r)return j;if(typeof r=="string"){var s=r.toLowerCase();x[s]&&(i=s),t&&(x[s]=t,i=s);var o=r.split("-");if(!i&&o.length>1)return a(o[0])}else{var c=r.name;x[c]=r,i=c}return!n&&i&&(j=i),i||!n&&j},h=function(a,r){if(L(a))return a.clone();var t=typeof r=="object"?r:{};return t.date=a,t.args=arguments,new d(t)},e=X;e.l=_,e.i=L,e.w=function(a,r){return h(a,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var d=function(){function a(t){this.$L=_(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[U]=!0}var r=a.prototype;return r.parse=function(t){this.$d=function(n){var i=n.date,s=n.utc;if(i===null)return new Date(NaN);if(e.u(i))return new Date;if(i instanceof Date)return new Date(i);if(typeof i=="string"&&!/Z$/i.test(i)){var o=i.match(R);if(o){var c=o[2]-1||0,u=(o[7]||"0").substring(0,3);return s?new Date(Date.UTC(o[1],c,o[3]||1,o[4]||0,o[5]||0,o[6]||0,u)):new Date(o[1],c,o[3]||1,o[4]||0,o[5]||0,o[6]||0,u)}}return new Date(i)}(t),this.init()},r.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},r.$utils=function(){return e},r.isValid=function(){return this.$d.toString()!==k},r.isSame=function(t,n){var i=h(t);return this.startOf(n)<=i&&i<=this.endOf(n)},r.isAfter=function(t,n){return h(t)<this.startOf(n)},r.isBefore=function(t,n){return this.endOf(n)<h(t)},r.$g=function(t,n,i){return e.u(t)?this[n]:this.set(i,t)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(t,n){var i=this,s=!!e.u(n)||n,o=e.p(t),c=function(E,y){var O=e.w(i.$u?Date.UTC(i.$y,y,E):new Date(i.$y,y,E),i);return s?O:O.endOf($)},u=function(E,y){return e.w(i.toDate()[E].apply(i.toDate("s"),(s?[0,0,0,0]:[23,59,59,999]).slice(y)),i)},f=this.$W,p=this.$M,g=this.$D,Y="set"+(this.$u?"UTC":"");switch(o){case D:return s?c(1,0):c(31,11);case b:return s?c(1,p):c(0,p+1);case N:var A=this.$locale().weekStart||0,z=(f<A?f+7:f)-A;return c(s?g-z:g+(6-z),p);case $:case v:return u(Y+"Hours",0);case T:return u(Y+"Minutes",1);case C:return u(Y+"Seconds",2);case w:return u(Y+"Milliseconds",3);default:return this.clone()}},r.endOf=function(t){return this.startOf(t,!1)},r.$set=function(t,n){var i,s=e.p(t),o="set"+(this.$u?"UTC":""),c=(i={},i[$]=o+"Date",i[v]=o+"Date",i[b]=o+"Month",i[D]=o+"FullYear",i[T]=o+"Hours",i[C]=o+"Minutes",i[w]=o+"Seconds",i[H]=o+"Milliseconds",i)[s],u=s===$?this.$D+(n-this.$W):n;if(s===b||s===D){var f=this.clone().set(v,1);f.$d[c](u),f.init(),this.$d=f.set(v,Math.min(this.$D,f.daysInMonth())).$d}else c&&this.$d[c](u);return this.init(),this},r.set=function(t,n){return this.clone().$set(t,n)},r.get=function(t){return this[e.p(t)]()},r.add=function(t,n){var i,s=this;t=Number(t);var o=e.p(n),c=function(p){var g=h(s);return e.w(g.date(g.date()+Math.round(p*t)),s)};if(o===b)return this.set(b,this.$M+t);if(o===D)return this.set(D,this.$y+t);if(o===$)return c(1);if(o===N)return c(7);var u=(i={},i[C]=S,i[T]=J,i[w]=P,i)[o]||1,f=this.$d.getTime()+t*u;return e.w(f,this)},r.subtract=function(t,n){return this.add(-1*t,n)},r.format=function(t){var n=this,i=this.$locale();if(!this.isValid())return i.invalidDate||k;var s=t||"YYYY-MM-DDTHH:mm:ssZ",o=e.z(this),c=this.$H,u=this.$m,f=this.$M,p=i.weekdays,g=i.months,Y=i.meridiem,A=function(y,O,B,V){return y&&(y[O]||y(n,s))||B[O].slice(0,V)},z=function(y){return e.s(c%12||12,y,"0")},E=Y||function(y,O,B){var V=y<12?"AM":"PM";return B?V.toLowerCase():V};return s.replace(Q,function(y,O){return O||function(B){switch(B){case"YY":return String(n.$y).slice(-2);case"YYYY":return e.s(n.$y,4,"0");case"M":return f+1;case"MM":return e.s(f+1,2,"0");case"MMM":return A(i.monthsShort,f,g,3);case"MMMM":return A(g,f);case"D":return n.$D;case"DD":return e.s(n.$D,2,"0");case"d":return String(n.$W);case"dd":return A(i.weekdaysMin,n.$W,p,2);case"ddd":return A(i.weekdaysShort,n.$W,p,3);case"dddd":return p[n.$W];case"H":return String(c);case"HH":return e.s(c,2,"0");case"h":return z(1);case"hh":return z(2);case"a":return E(c,u,!0);case"A":return E(c,u,!1);case"m":return String(u);case"mm":return e.s(u,2,"0");case"s":return String(n.$s);case"ss":return e.s(n.$s,2,"0");case"SSS":return e.s(n.$ms,3,"0");case"Z":return o}return null}(y)||o.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(t,n,i){var s,o=this,c=e.p(n),u=h(t),f=(u.utcOffset()-this.utcOffset())*S,p=this-u,g=function(){return e.m(o,u)};switch(c){case D:s=g()/12;break;case b:s=g();break;case F:s=g()/3;break;case N:s=(p-f)/6048e5;break;case $:s=(p-f)/864e5;break;case T:s=p/J;break;case C:s=p/S;break;case w:s=p/P;break;default:s=p}return i?s:e.a(s)},r.daysInMonth=function(){return this.endOf(b).$D},r.$locale=function(){return x[this.$L]},r.locale=function(t,n){if(!t)return this.$L;var i=this.clone(),s=_(t,n,!0);return s&&(i.$L=s),i},r.clone=function(){return e.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},a}(),m=d.prototype;return h.prototype=m,[["$ms",H],["$s",w],["$m",C],["$H",T],["$W",$],["$M",b],["$y",D],["$D",v]].forEach(function(a){m[a[1]]=function(r){return this.$g(r,a[0],a[1])}}),h.extend=function(a,r){return a.$i||(a(r,d,h),a.$i=!0),h},h.locale=_,h.isDayjs=L,h.unix=function(a){return h(1e3*a)},h.en=x[j],h.Ls=x,h.p={},h})})(oe);var ve=oe.exports;const Me=ce(ve),ee=[{id:"membershipId",label:"ID",minWidth:120},{id:"applicationNumber",label:"Application Number",minWidth:180},{id:"membershipCode",label:"Membership Code",minWidth:180},{id:"referanceMembershipCode",label:"Reference Membership Code",minWidth:200},{id:"isAlive",label:"Is Alive",minWidth:120},{id:"fullName",label:"Full Name",minWidth:200},{id:"dob",label:"Date of Birth",minWidth:160},{id:"age",label:"Age",minWidth:120},{id:"bloodGroup",label:"Blood Group",minWidth:150},{id:"mobileNumber",label:"Mobile Number",minWidth:180},{id:"alternativeMobileNumber",label:"Alternative Mobile Number",minWidth:200},{id:"gothra",label:"Gothra",minWidth:150},{id:"emailId",label:"Email ID",minWidth:200},{id:"gender",label:"Gender",minWidth:120},{id:"isMarried",label:"Is Married",minWidth:160},{id:"femaleFamilyRefMembershipCode",label:"Female Family Ref Membership Code",minWidth:200},{id:"occupation",label:"Occupation",minWidth:180},{id:"qualification",label:"Qualification",minWidth:180},{id:"address",label:"Address",minWidth:250},{id:"city",label:"City",minWidth:150},{id:"country",label:"Country",minWidth:150},{id:"edit",label:"Edit",align:"center",minWidth:120},{id:"delete",label:"Delete",align:"center",minWidth:120}],ke=()=>{const q=de(),[G,P]=M.useState(0),[S,J]=M.useState(10),[H,w]=M.useState([]),[C,T]=M.useState(0),[$,N]=M.useState(null),[b,F]=M.useState(!1),[D,v]=M.useState(!1),[k,R]=M.useState(null),[Q,K]=M.useState(null),[W,X]=M.useState(!1);M.useEffect(()=>{j()},[G,S]);const j=async()=>{try{const e=JSON.parse(sessionStorage.getItem("user")),d=(e==null?void 0:e.accessToken)||"",m=await fetch(`https://executivetracking.cloudjiffy.net/Mahaasabha/membership/v1/getAllApplicationNoMembershipByPagination/{pageNumber}/{pageSize}?pageNumber=${G}&pageSize=${S}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`}});if(!m.ok){const r=await m.text();throw new Error(`Error: ${m.status} - ${r}`)}const a=await m.json();w(a.content||[]),T(a.totalElements||0)}catch(e){N(`Failed to fetch family data: ${e.message}`),console.error("Error fetching family data:",e)}},x=(e={})=>{X(!e.membershipId),R(e),F(!0)},U=async()=>{try{const e=JSON.parse(sessionStorage.getItem("user")),d=(e==null?void 0:e.accessToken)||"",m=W?"https://executivetracking.cloudjiffy.net/Mahaasabha/membership/v1/createFamilyMembership?userId=1":`https://executivetracking.cloudjiffy.net/Mahaasabha/membership/v1/updateFamily/${k.membershipId}`,r=await fetch(m,{method:W?"POST":"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(k)});if(!r.ok)throw new Error(`Error: ${r.status}`);F(!1),alert(W?"Family record created!":"Family record updated!"),j()}catch(e){console.error("Failed to save family data:",e)}},L=async()=>{try{const e=JSON.parse(sessionStorage.getItem("user")),d=(e==null?void 0:e.accessToken)||"",m=await fetch(`https://executivetracking.cloudjiffy.net/Mahaasabha/membership/v1/deleteFamily/${Q}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`}});if(!m.ok)throw new Error(`Error: ${m.status}`);v(!1),j()}catch(e){console.error("Failed to delete family data:",e)}},_=e=>e?Me(e).format("YYYY-MM-DD"):"Not Available",h=e=>e===!0?"Yes":e===!1?"No":e==null||e===""?"Not Available":e;return l.jsxs(ue,{title:"Family Details",children:[l.jsx(te,{container:!0,spacing:he,justifyContent:"flex-end",children:l.jsx(te,{item:!0,children:l.jsx(I,{variant:"contained",color:"primary",onClick:()=>x(),children:"Add Family"})})}),l.jsxs(fe,{sx:{width:"100%",overflow:"hidden",marginTop:q.spacing(2)},children:[$&&l.jsxs("div",{style:{color:"red"},children:["Error: ",$]}),l.jsx(pe,{sx:{maxHeight:440},children:l.jsxs(ye,{stickyHeader:!0,"aria-label":"sticky table",children:[l.jsx(be,{children:l.jsx(re,{children:ee.map(e=>l.jsx(Z,{align:e.align,style:{minWidth:e.minWidth,fontWeight:600,fontSize:15,padding:"16px 24px"},children:e.label},e.id))})}),l.jsx(ge,{children:H.map(e=>l.jsx(re,{hover:!0,role:"checkbox",tabIndex:-1,children:ee.map(d=>{const m=e[d.id];return d.id==="edit"?l.jsx(Z,{align:d.align,children:l.jsx(I,{variant:"outlined",color:"primary",onClick:()=>x(e),children:"Edit"})},d.id):d.id==="delete"?l.jsx(Z,{align:d.align,children:l.jsx(I,{variant:"outlined",color:"secondary",onClick:()=>{K(e.membershipId),v(!0)},children:"Delete"})},d.id):l.jsx(Z,{align:d.align,children:d.id==="dob"?_(m):h(m)},d.id)})},e.membershipId))})]})}),l.jsx($e,{rowsPerPageOptions:[10,25,100],component:"div",count:C,rowsPerPage:S,page:G,onPageChange:(e,d)=>P(d),onRowsPerPageChange:e=>J(+e.target.value)})]}),l.jsxs(ie,{open:b,onClose:()=>F(!1),children:[l.jsx(ne,{children:W?"Add New Family Member":"Edit Family Details"}),l.jsx(ae,{children:ee.map(e=>["membershipId","applicationNumber","edit","delete"].includes(e.id)?null:l.jsx(me,{margin:"dense",label:e.label,fullWidth:!0,variant:"outlined",value:(k==null?void 0:k[e.id])||"",onChange:d=>R(m=>({...m,[e.id]:d.target.value}))},e.id))}),l.jsxs(se,{children:[l.jsx(I,{onClick:()=>F(!1),color:"secondary",children:"Cancel"}),l.jsx(I,{onClick:U,color:"primary",children:"Save"})]})]}),l.jsxs(ie,{open:D,onClose:()=>v(!1),children:[l.jsx(ne,{children:"Confirm Deletion"}),l.jsx(ae,{children:"Are you sure you want to delete this family record?"}),l.jsxs(se,{children:[l.jsx(I,{onClick:()=>v(!1),color:"primary",children:"Cancel"}),l.jsx(I,{onClick:L,color:"secondary",children:"Delete"})]})]})]})};export{ke as default};
