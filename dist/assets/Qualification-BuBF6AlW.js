import{r as l,j as a,c as F,b as g,I as w,T as I}from"./index-BCMjTDj-.js";import{d as z}from"./Edit-BAFAy0Gz.js";import{d as J}from"./Delete-DQ5tIu97.js";import{T as M,a as R,b as L,c as N,d as b,e as U}from"./TableRow-C6k8ikuc.js";import{T as H}from"./TablePagination-au4wXnx7.js";import{D as _,a as G}from"./DialogTitle-D85XLa7F.js";import{D as K}from"./DialogContent-B8Y-o2C7.js";import{D as V}from"./DialogActions-Db_kJuz6.js";import"./LastPage-aK0Jz_ev.js";const x=[{id:"qualificationId",label:"ID",minWidth:50},{id:"qualificationName",label:"Qualification Name",minWidth:150},{id:"description",label:"Description",minWidth:200},{id:"createdBy",label:"Created By",minWidth:150},{id:"updatedBy",label:"Updated By",minWidth:150},{id:"insertedDate",label:"Inserted Date",minWidth:180},{id:"updatedDate",label:"Updated Date",minWidth:180},{id:"actions",label:"Actions",minWidth:100,align:"center"}],se=()=>{const[m,y]=l.useState(0),[h,S]=l.useState(10),[D,C]=l.useState([]),[v,B]=l.useState(0),[j,c]=l.useState(null),[k,T]=l.useState(!1),[p,E]=l.useState("add"),[s,d]=l.useState({qualificationId:0,qualificationName:"",description:"",createdBy:{fullName:"",mobileNumber:"",userId:0,userName:""},updatedBy:{fullName:"",mobileNumber:"",userId:0,userName:""},insertedDate:"",updatedDate:""});l.useEffect(()=>{u()},[m,h]);const u=async()=>{try{const e=JSON.parse(sessionStorage.getItem("user")),i=(e==null?void 0:e.accessToken)||"",t=await fetch(`https://executivetracking.cloudjiffy.net/Mahaasabha/qualification/v1/getAllQualificationByPagination/{pageNumber}/{pageSize}?pageNumber=${m}&pageSize=${h}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}});if(!t.ok)throw new Error(`Error: ${t.statusText}`);const o=await t.json(),r=o.content.map(n=>({qualificationId:n.qualificationId,qualificationName:n.qualificationName,description:n.description,createdBy:n.createdBy.fullName||n.createdBy.userName,updatedBy:n.updatedBy.fullName||n.updatedBy.userName,insertedDate:new Date(n.insertedDate).toLocaleDateString(),updatedDate:new Date(n.updatedDate).toLocaleDateString()}));C(r),B(o.totalElements)}catch(e){c(e.message),console.error("Failed to fetch qualifications:",e)}},P=(e,i)=>{y(i)},Q=e=>{S(+e.target.value),y(0)},q=(e,i={})=>{E(e),d(i),T(!0)},f=()=>{T(!1),d({qualificationId:0,qualificationName:"",description:"",createdBy:{fullName:"",mobileNumber:"",userId:0,userName:""},updatedBy:{fullName:"",mobileNumber:"",userId:0,userName:""},insertedDate:"",updatedDate:""})},A=()=>{p==="add"?O():W()},O=async()=>{try{const e=JSON.parse(sessionStorage.getItem("user")||"{}"),i=(e==null?void 0:e.accessToken)||"",t={qualificationName:s.qualificationName,description:s.description,createdBy:{fullName:e.fullName||e.userName,mobileNumber:e.mobileNumber,userId:e.userId,userName:e.userName},updatedBy:{fullName:e.fullName||e.userName,mobileNumber:e.mobileNumber,userId:e.userId,userName:e.userName},insertedDate:new Date().toISOString(),updatedDate:new Date().toISOString()};console.log("Adding Qualification Payload:",t);const o=await fetch("https://executivetracking.cloudjiffy.net/Mahaasabha/qualification/v1/createQualification",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(t)});if(!o.ok){const r=await o.json();throw console.error("Failed to add qualification:",r),new Error(`Error: ${o.statusText}`)}u(),f()}catch(e){c(e.message),console.error("Failed to add qualification:",e)}},W=async()=>{try{const e=JSON.parse(sessionStorage.getItem("user")||"{}"),i=(e==null?void 0:e.accessToken)||"",t={qualificationId:s.qualificationId,qualificationName:s.qualificationName,description:s.description};console.log("Editing Qualification Payload:",t);const o=await fetch("https://executivetracking.cloudjiffy.net/Mahaasabha/qualification/v1/updateQualification",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(t)});if(!o.ok){const r=await o.json();throw console.error("Failed to edit qualification:",r),new Error(`Error: ${o.statusText}`)}u(),f()}catch(e){c(e.message),console.error("Failed to edit qualification:",e)}},$=async e=>{if(window.confirm("Are you sure you want to delete this qualification?"))try{const t=JSON.parse(sessionStorage.getItem("user")||"{}"),o=(t==null?void 0:t.accessToken)||"",r=await fetch(`https://executivetracking.cloudjiffy.net/Mahaasabha/qualification/v1/deleteQualificationById/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}});if(!r.ok){const n=await r.json();throw console.error("Failed to delete qualification:",n),new Error(`Error: ${r.statusText}`)}u()}catch(t){c(t.message),console.error("Failed to delete qualification:",t)}};return a.jsxs(F,{sx:{width:"100%",overflow:"hidden",mt:5},children:[a.jsx(g,{variant:"contained",sx:{margin:"10px"},onClick:()=>q("add"),children:"+ ADD QUALIFICATION"}),j&&a.jsxs("div",{style:{color:"red",textAlign:"center"},children:["Error: ",j]}),a.jsx(M,{sx:{maxHeight:440},children:a.jsxs(R,{stickyHeader:!0,"aria-label":"sticky table",children:[a.jsx(L,{children:a.jsx(N,{children:x.map(e=>a.jsx(b,{align:e.align||"left",style:{minWidth:e.minWidth,fontWeight:"bold"},children:e.label},e.id))})}),a.jsx(U,{children:D.length>0?D.map(e=>a.jsx(N,{hover:!0,role:"checkbox",tabIndex:-1,children:x.map(i=>{const t=e[i.id];return a.jsx(b,{align:i.align||"left",children:i.id==="actions"?a.jsxs(a.Fragment,{children:[a.jsx(w,{onClick:()=>q("edit",e),color:"primary",children:a.jsx(z,{})}),a.jsx(w,{onClick:()=>$(e.qualificationId),color:"secondary",children:a.jsx(J,{})})]}):t||"Not Available"},i.id)})},e.qualificationId)):a.jsx(N,{children:a.jsx(b,{colSpan:x.length,align:"center",sx:{padding:20},children:"No rows"})})})]})}),a.jsx(H,{rowsPerPageOptions:[10,25,100],component:"div",count:v,rowsPerPage:h,page:m,onPageChange:P,onRowsPerPageChange:Q}),a.jsxs(_,{open:k,onClose:f,children:[a.jsx(G,{children:p==="add"?"Add Qualification":"Edit Qualification"}),a.jsxs(K,{children:[a.jsx(I,{autoFocus:!0,margin:"dense",label:"Qualification Name",fullWidth:!0,variant:"outlined",value:s.qualificationName,onChange:e=>d({...s,qualificationName:e.target.value})}),a.jsx(I,{margin:"dense",label:"Description",fullWidth:!0,variant:"outlined",value:s.description,onChange:e=>d({...s,description:e.target.value})})]}),a.jsxs(V,{children:[a.jsx(g,{onClick:f,children:"Cancel"}),a.jsx(g,{onClick:A,children:p==="add"?"Add":"Save"})]})]})]})};export{se as default};
